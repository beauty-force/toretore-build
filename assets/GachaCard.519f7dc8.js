import{B as L,m as V,L as D,h as w,K as O,r as M,o as n,c as o,b as s,a as p,w as v,f as d,t as r,g as y,F as H,n as q,j as z}from"./app.595b0342.js";import{_ as j}from"./_plugin-vue_export-helper.cdc0426e.js";/*! vue-countdown v2.1.3 | (c) 2018-present Chen Fengyuan | MIT */const h=1e3,m=60*h,g=60*m,S=24*g,k="abort",E="end",C="progress",I="start",N="visibilitychange";var B=L({name:"VueCountdown",props:{autoStart:{type:Boolean,default:!0},emitEvents:{type:Boolean,default:!0},interval:{type:Number,default:1e3,validator:e=>e>=0},now:{type:Function,default:()=>Date.now()},tag:{type:String,default:"span"},time:{type:Number,default:0,validator:e=>e>=0},transform:{type:Function,default:e=>e}},emits:[k,E,C,I],data(){return{counting:!1,endTime:0,totalMilliseconds:0,requestId:0,autoPauseOnHide:!1}},computed:{days(){return Math.floor(this.totalMilliseconds/S)},hours(){return Math.floor(this.totalMilliseconds%S/g)},minutes(){return Math.floor(this.totalMilliseconds%g/m)},seconds(){return Math.floor(this.totalMilliseconds%m/h)},milliseconds(){return Math.floor(this.totalMilliseconds%h)},totalDays(){return this.days},totalHours(){return Math.floor(this.totalMilliseconds/g)},totalMinutes(){return Math.floor(this.totalMilliseconds/m)},totalSeconds(){return Math.floor(this.totalMilliseconds/h)}},watch:{$props:{deep:!0,immediate:!0,handler(){this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.autoStart&&this.start()}}},mounted(){document.addEventListener(N,this.handleVisibilityChange)},beforeUnmount(){document.removeEventListener(N,this.handleVisibilityChange),this.pause()},methods:{start(){this.counting||(this.counting=!0,this.autoStart||(this.totalMilliseconds=this.time,this.endTime=this.now()+this.time),this.emitEvents&&this.$emit(I),document.visibilityState==="visible"&&this.continue())},continue(){if(!this.counting)return;const e=Math.min(this.totalMilliseconds,this.interval);if(e>0){let i,t;const u=l=>{i||(i=l),t||(t=l);const a=l-i;a>=e||a+(l-t)/2>=e?this.progress():this.requestId=requestAnimationFrame(u),t=l};this.requestId=requestAnimationFrame(u)}else this.end()},pause(){cancelAnimationFrame(this.requestId),this.requestId=0},progress(){!this.counting||(this.update(),this.emitEvents&&this.totalMilliseconds>0&&this.$emit(C,{days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}),this.continue())},abort(){!this.counting||(this.pause(),this.counting=!1,this.emitEvents&&this.$emit(k))},end(){!this.counting||(this.pause(),this.totalMilliseconds=0,this.counting=!1,this.emitEvents&&this.$emit(E))},update(){this.counting&&(this.totalMilliseconds=Math.max(0,this.endTime-this.now()))},restart(){this.pause(),this.totalMilliseconds=this.time,this.endTime=this.now()+this.time,this.counting=!1,this.start()},handleVisibilityChange(){switch(document.visibilityState){case"visible":this.requestId===0&&this.autoPauseOnHide&&(this.update(),this.continue()),this.autoPauseOnHide=!1;break;case"hidden":this.requestId>0&&(this.autoPauseOnHide=!0,this.pause());break}}},render(){return V(this.tag,this.$slots.default?[this.$slots.default(this.transform({days:this.days,hours:this.hours,minutes:this.minutes,seconds:this.seconds,milliseconds:this.milliseconds,totalDays:this.totalDays,totalHours:this.totalHours,totalMinutes:this.totalMinutes,totalSeconds:this.totalSeconds,totalMilliseconds:this.totalMilliseconds}))]:void 0)}});const A={components:{Link:D,VueCountdown:B},props:{gacha:Object,url_edit:String},data(){return{category_share:w().props.value.category_share,url_card:"",url_10gacha:"",url_1gacha:"",str_gacha10:"",point_10gacha:0,countdown:this.gacha.remaining>0}},methods:{get_progress_value(){let e=Math.round(this.gacha.count_rest*100/this.gacha.count_card),i="bg-red-500";return e>33&&(i="bg-yellow-500"),e>66&&(i="bg-green-500"),{value:e,bg_color:i}},format_number(e){return String(e).replace(/(.)(?=(\d{3})+$)/g,"$1,")},getImageClass(e){return"url('"+e+"')"},clickCard(){var e;(this.gacha.count_rest>0||((e=w().props.value.auth.user)==null?void 0:e.type)>0)&&(window.location.href=this.url_card)},destroyGacha(e){confirm("\u524A\u9664\u3057\u3066\u3082\u3044\u3044\u3067\u3059\u304B\uFF1F")&&O.Inertia.delete(route("admin.gacha.destroy",{id:e}))},transform(e){return Object.entries(e).forEach(([i,t])=>{const u=t<10&&i!="days"?`0${t}`:t;t<2&&i.replace(/s$/,""),e[i]=`${u}`}),e}},mounted(){this.gacha.count_rest<10?(this.str_gacha10="\u5168\u3066",this.point_10gacha=this.gacha.count_rest*this.gacha.point):(this.str_gacha10="10\u9023",this.point_10gacha=10*this.gacha.point),this.url_edit||(this.url_card=route("user.gacha",this.gacha.id)+this.category_share.cat_route_appendix)}},F={class:"cursor-pointer border-4 border-[#60493d] mb-0 relative rounded-[20px] shadow w-full bg-cover overflow-hidden bg-[#60493d]"},P=["data-src"],G={key:0,class:"absolute inset-0 flex bg-gradient-to-t from-neutral-900/10 via-neutral-900/90 to-neutral-900/10 items-center"},R={class:"w-full py-12 bg-gradient-to-t from-transparent via-neutral-900/90 to-transparent"},U={class:"text-base"},Y={key:0},K={key:1},J={class:"text-center"},Q={class:"bg-gradient-to-r from-amber-300 to-amber-500 via-amber-400 bg-clip-text text-transparent font-black text-4xl font-[mplus2] tracking-wider"},W={key:0,class:"mr-3"},X={key:1,class:"absolute top-0 right-0 flex items-center justify-center"},Z={class:"bg-neutral-900/90 px-3 py-1 relative"},$={class:"text-xs"},tt={key:0},et={key:1},st={class:"text-center"},it={class:"bg-gradient-to-r from-amber-300 to-amber-500 via-amber-400 bg-clip-text text-transparent font-black text-lg font-[mplus2] tracking-wider"},at={key:0,class:"mr-1"},nt={key:0,class:"absolute z-20 top-0 left-0 items-center px-2 py-1 bg-green-500 border border-transparent rounded-sm font-semibold text-sm text-white tracking-widest"},ot={key:1,class:"absolute z-20 top-0 left-0 items-center px-2 py-1 bg-neutral-500 border border-transparent rounded-sm font-semibold text-sm text-white tracking-widest"},rt=s("img",{"data-src":"/images/sold_out.png",class:"w-[75%] lazy"},null,-1),lt=[rt],ct={class:"bottom-0 w-full p-2 rounded-b-[20px]"},dt={class:"px-4 text-white"},ut={class:"px-1 flex flex-row justify-between mb-1"},ht=s("span",{class:"text-sm"},"\u6B8B ",-1),mt={class:"font-semibold text-base"},gt={class:"text-sm"},_t=s("span",{class:"inline-block align-middle pr-2"},[s("img",{class:"h-5",src:"/images/icon_cash.png"})],-1),ft={class:"font-semibold"},bt=s("span",null,"PT",-1),pt={class:"mb-1"},vt={class:"w-full bg-gray-200 rounded-full h-4 dark:bg-gray-700 overflow-hidden"};function yt(e,i,t,u,l,a){const x=M("vue-countdown"),T=M("Link");return n(),o("div",F,[s("div",{onClick:i[2]||(i[2]=c=>a.clickCard())},[s("img",{"data-src":t.gacha.thumbnail,class:"lazy"},null,8,P),l.countdown&&t.gacha.timeStatus==0?(n(),o("div",G,[s("div",R,[p(x,{time:t.gacha.remaining*1e3,transform:a.transform,class:"text-amber-100 flex flex-col items-center justify-center px-2 py-1 w-full text-xl font-bold",onEnd:i[0]||(i[0]=c=>l.countdown=!1)},{default:v(({days:c,hours:_,minutes:f,seconds:b})=>[s("div",U,[t.gacha.timeStatus==0?(n(),o("span",Y,"\u767A\u58F2\u307E\u3067")):d("",!0),t.gacha.timeStatus==1?(n(),o("span",K,"\u7D42\u4E86\u307E\u3067")):d("",!0)]),s("div",J,[s("span",Q,[c>0?(n(),o("span",W,r(c)+"\u65E5",1)):d("",!0),y(r(_)+":"+r(f)+":"+r(b),1)])])]),_:1},8,["time","transform"])])])):d("",!0),l.countdown&&t.gacha.timeStatus==1?(n(),o("div",X,[s("div",Z,[p(x,{time:t.gacha.remaining*1e3,transform:a.transform,class:"text-amber-100 flex flex-col items-center justify-center text-sm font-bold",onEnd:i[1]||(i[1]=c=>l.countdown=!1)},{default:v(({days:c,hours:_,minutes:f,seconds:b})=>[s("div",$,[t.gacha.timeStatus==0?(n(),o("span",tt,"\u767A\u58F2\u307E\u3067")):d("",!0),t.gacha.timeStatus==1?(n(),o("span",et,"\u7D42\u4E86\u307E\u3067")):d("",!0)]),s("div",st,[s("span",it,[c>0?(n(),o("span",at,r(c)+"\u65E5",1)):d("",!0),y(r(_)+":"+r(f)+":"+r(b),1)])])]),_:1},8,["time","transform"])])])):d("",!0)]),t.url_edit?(n(),o(H,{key:0},[p(T,{href:t.url_edit,class:"absolute z-20 top-0 right-0 items-center px-8 py-2.5 bg-green-500 border border-transparent rounded-sm font-semibold text-sm text-white uppercase tracking-widest hover:bg-green-700 active:bg-green-700 focus:outline-none focus:border-green-700 focus:shadow-outline-green transition ease-in-out duration-150"},{default:v(()=>[y(" \u7DE8\u96C6\u3059\u308B ")]),_:1},8,["href"]),t.gacha.status==1?(n(),o("div",nt," \u516C\u958B ")):(n(),o("div",ot," \u975E\u516C\u958B ")),s("button",{onClick:i[3]||(i[3]=c=>a.destroyGacha(t.gacha.id)),class:"z-20 rounded absolute bottom-0 right-0 px-4 py-2 bg-red-500 text-xs text-neutral-50"}," \u524A\u9664 ")],64)):d("",!0),t.gacha.count_rest==0&&!t.url_edit?(n(),o("div",{key:1,class:"absolute bottom-0 w-full h-full bg-opacity-70 z-10 bg-black flex items-center justify-center",onClick:i[4]||(i[4]=c=>a.clickCard())},lt)):d("",!0),s("div",ct,[s("div",dt,[s("div",ut,[s("div",null,[ht,s("span",mt,r(a.format_number(t.gacha.count_rest)),1),s("span",gt,"/"+r(a.format_number(t.gacha.count_card)),1)]),s("div",null,[_t,s("span",ft,r(a.format_number(t.gacha.point)),1),bt])]),s("div",pt,[s("div",vt,[s("div",{class:q(["h-4 rounded-full",a.get_progress_value().bg_color]),style:z({width:a.get_progress_value().value+"%"})},null,6)])])])])])}const Mt=j(A,[["render",yt]]);export{Mt as G};
