import{A as F,x as B,o as l,c as r,a as k,G as v,i as E,w as N,H as O,b as t,t as o,g as z,f as I,F as A,I as V,n as R}from"./app.d488ce6b.js";import{A as $}from"./Admin.e8e83fa7.js";import{C,A as H,p as X,a as Y,D as G}from"./index.6da6e6e7.js";import"./toastify.a2974c8f.js";import"./_plugin-vue_export-helper.cdc0426e.js";const q={class:"relative w-full mx-auto h-64"},P={__name:"RankProgressChart",props:{label:String,currentAmount:Number,totalAmount:Number,color:String,marks:Array},setup(a){var D;const s=a;C.register(H,X,Y),F(()=>s.currentAmount/s.totalAmount*100);const i=Math.min(s.currentAmount,s.totalAmount),n=F(()=>({labels:["\u73FE\u5728",s.label],datasets:[{data:[i,s.totalAmount-i],backgroundColor:[s.color,"#E0E0E0"],hoverBackgroundColor:[s.color,"#C0C0C0"]}]})),g={id:"drawMarks",afterDraw(f,L,_){const{ctx:e,chartArea:u}=f;if(!u||!_.marks||!_.totalAmount)return;const b=f.getDatasetMeta(0);if(!b||!b.data.length)return;const w=(u.left+u.right)/2,M=(u.top+u.bottom)/2,d=b.data[0].outerRadius-0;e.save(),e.textBaseline="middle",e.font="normal 12px kei-font",e.fillStyle="black",_.marks.forEach(({amount:x,title:Tt,bonus:j})=>{const h=x/_.totalAmount,c=h*(Math.PI*2)-Math.PI/2,p=w+Math.cos(c)*d,y=M+Math.sin(c)*d;e.textAlign="center",h>.1&&h<.4?e.textAlign="start":h>.6&&h<.9&&(e.textAlign="end");const S=d*.19;e.strokeStyle=x<=i?"gray":"#FF6600",e.beginPath(),e.moveTo(w+Math.cos(c)*(d-S),M+Math.sin(c)*(d-S)),e.lineTo(p,y),e.stroke();const m=d*.05;e.save(),e.translate(p,y),e.rotate(c-Math.PI/2),e.fillStyle=x<=i?"gray":"#FF6600",e.beginPath(),e.moveTo(0,-m),e.lineTo(-m,m),e.lineTo(m,m),e.closePath(),e.fill(),e.restore(),e.fillStyle=x<=i?"gray":"#FF6600",e.fillText(`${j}pt`,p+Math.cos(c)*10,y+Math.sin(c)*15)}),e.restore()}};B(()=>{C.register(g)});const T={responsive:!0,maintainAspectRatio:!1,cutout:"80%",layout:{padding:30},plugins:{legend:{display:!1},drawMarks:{marks:s.marks,totalAmount:(D=s.totalAmount)!=null?D:[]}}};return(f,L)=>(l(),r("div",q,[k(v(G),{data:v(n),options:T},null,8,["data"])]))}},J={class:"px-4 bg-neutral-100 py-6"},K={class:"text-center"},Q={class:"text-xl font-semibold mb-4 text-rose-500"},U={class:"mt-2 text-sm text-neutral-500 flex gap-2 justify-center items-center"},W=t("span",null,"\u73FE\u5728\u306E\u30E9\u30F3\u30AF\u306E\u5931\u52B9\u65E5:",-1),Z={class:"text-rose-500 text-base"},tt={class:"mt-1 text-sm text-neutral-500 flex items-center justify-center gap-2"},et=t("span",null,"\u73FE\u5728\u306E\u30E9\u30F3\u30AF\u306E\u53D6\u5F15\u91D1\u984D:",-1),at={class:"text-lg text-black font-bold"},st={class:"grid md:grid-cols-2 gap-4 mt-6 bg-white rounded-2xl shadow-sm py-8"},nt={key:0,class:"text-center"},ot={class:"font-bold"},lt={class:"text-[#FFD700] text-[mplus2] font-black"},rt={class:"relative"},ct={class:"absolute w-full h-full top-0 flex flex-col items-center justify-center"},it=t("span",{class:"text-xs md:text-sm"},"\u3042\u3068",-1),dt={class:"text-base md:text-lg font-bold"},ut={class:"text-center"},ht=t("h2",{class:"text-gray-600 font-bold"},"\u4F1A\u54E1\u30E9\u30F3\u30AF\u3092\u30AD\u30FC\u30D7",-1),mt={class:"relative"},_t={class:"absolute w-full h-full top-0 flex flex-col items-center justify-center"},xt=t("span",{class:"text-xs md:text-sm"},"\u3042\u3068",-1),kt={class:"text-base md:text-lg font-bold"},gt=t("span",{class:"text-xs md:text-sm"},"\u30E9\u30F3\u30AF\u7DAD\u6301\u6761\u4EF6",-1),ft=t("span",{class:"text-base md:text-lg font-bold text-rose-500"},"\u9054\u6210\u6E08\u307F",-1),bt={class:"mt-6"},pt=t("h2",{class:"font-bold text-lg mb-4"},"\u30E9\u30F3\u30AF\u4E00\u89A7",-1),yt={class:"w-full overflow-auto text-sm"},At={class:"min-w-full bg-white shadow rounded-lg"},vt=t("thead",null,[t("tr",{class:"bg-gray-200 whitespace-nowrap"},[t("th",{class:"p-2"},"\u30E9\u30F3\u30AF\u540D"),t("th",{class:"p-2"},"\u5230\u9054\u91D1\u984D"),t("th",{class:"p-2"},"\u30DC\u30FC\u30CA\u30B9PT"),t("th",{class:"p-2"},"\u7DAD\u6301\u671F\u65E5"),t("th",{class:"p-2"},"\u7DAD\u6301\u91D1\u984D")])],-1),Dt={class:"font-bold p-2 text-center"},wt={class:"p-2 text-center"},Mt={class:"p-2 text-center"},St={key:0,class:"p-2 text-center"},Ft={key:1,class:"p-2 text-center"},Ct={key:2,class:"p-2 text-center"},Pt={key:3,class:"p-2 text-center"},Ot={__name:"MyPage",props:{ranks:Object,rankData:Object,middle_bonus:Object,monthly_transactions:Array},setup(a){return(s,i)=>(l(),E($,null,{default:N(()=>[k(v(O),{title:"\u30DE\u30A4\u30DA\u30FC\u30B8"}),t("div",J,[t("div",K,[t("h2",Q,o(a.rankData.rank),1),t("div",U,[W,t("span",Z,o(a.rankData.expiry_date),1)]),t("div",tt,[et,t("span",at,"\xA5 "+o(a.rankData.current_amount.toLocaleString()),1)])]),t("div",st,[a.rankData.total_needed>0?(l(),r("div",nt,[t("h2",ot,[t("span",lt,o(a.rankData.next_rank),1),z("\u4F1A\u54E1\u307E\u3067")]),t("div",rt,[k(P,{label:"\u3042\u3068",currentAmount:a.rankData.current_amount,totalAmount:a.rankData.total_needed,color:"#FFD700",marks:a.middle_bonus,class:"absolute z-10"},null,8,["currentAmount","totalAmount","marks"]),t("div",ct,[it,t("span",dt,"\xA5 "+o((a.rankData.total_needed-a.rankData.current_amount).toLocaleString()),1)])])])):I("",!0),t("div",ut,[ht,t("div",mt,[k(P,{label:"\u3042\u3068",currentAmount:a.rankData.current_amount,totalAmount:a.rankData.rank_keep_threshold,color:"#A9A9A9",class:"absolute z-10"},null,8,["currentAmount","totalAmount"]),t("div",_t,[a.rankData.current_amount<a.rankData.rank_keep_threshold?(l(),r(A,{key:0},[xt,t("span",kt,"\xA5 "+o((a.rankData.rank_keep_threshold-a.rankData.current_amount).toLocaleString()),1)],64)):(l(),r(A,{key:1},[gt,ft],64))])])])]),t("div",bt,[pt,t("div",yt,[t("table",At,[vt,t("tbody",null,[(l(!0),r(A,null,V(a.ranks,(n,g)=>(l(),r("tr",{key:g,class:R(["whitespace-nowrap border-b",{"bg-yellow-100":n.rankup==1,"bg-gray-50":n.rankup==0}])},[t("td",Dt,o(n.title),1),t("td",wt,"\xA5 "+o(n.amount.toLocaleString()),1),t("td",Mt,o(n.bonus.toLocaleString())+" PT",1),n.rankup?(l(),r("td",St,o(n.expiration)+"\u65E5",1)):(l(),r("td",Ft,"-")),n.rankup?(l(),r("td",Ct,"\xA5 "+o(n.limit.toLocaleString()),1)):(l(),r("td",Pt,"-"))],2))),128))])])])])])]),_:1}))}};export{Ot as default};
