import{H as L,L as H,r as h,o,c as n,a as d,w as f,F as g,b as t,t as l,g as G,I as j,f as u,n as k,d as I}from"./app.599ecf86.js";import{U as N}from"./UserLayout.7d0f890c.js";import{P as T}from"./Pagination.712e83b6.js";import{G as A}from"./GachaButtons.0b7c09e7.js";import{_ as M}from"./_plugin-vue_export-helper.cdc0426e.js";import{N as W,d as z,o as E,f as F,r as U,a as V}from"./toastify.9e1b0457.js";import{r as X}from"./ChevronRightIcon.cfecd3b7.js";import"./EllipsisHorizontalIcon.9ea53326.js";import"./PlayIcon.971fdad4.js";const Y={components:{Head:L,UserLayout:N,Pagination:T,Link:H,GachaButtons:A,Dialog:W,DialogPanel:z,TransitionChild:E,TransitionRoot:F,XMarkIcon:U,ChevronLeftIcon:V,ChevronRightIcon:X},props:{errors:Object,gachas:Object,category_share:Object,gacha_log:Array,is_admin:Boolean,search_cond:Object,total:Number,offset:Number,productsGrouped:Object},data(){return{sliderOpen:!1,currentRank:"",currentIndex:0}},computed:{sortedRanks(){if(!this.productsGrouped)return{};const r=["S","A","B","C","D"],a={};return r.forEach(s=>{this.productsGrouped[s]&&(a[s]=this.productsGrouped[s])}),a},currentProducts(){return!this.currentRank||!this.productsGrouped[this.currentRank]?[]:this.productsGrouped[this.currentRank]},allProducts(){if(!this.productsGrouped)return[];const r=[];return["S","A","B","C","D"].forEach(s=>{this.productsGrouped[s]&&this.productsGrouped[s].forEach(_=>{r.push({..._,productRank:s})})}),r},currentProductRank(){return this.allProducts.length===0||this.currentIndex<0||this.currentIndex>=this.allProducts.length?"":this.allProducts[this.currentIndex].productRank||""}},methods:{format_number(r){return String(r).replace(/(.)(?=(\d{3})+$)/g,"$1,")},openSlider(r,a){const s=["S","A","B","C","D"];let _=0;for(let i=0;i<s.length;i++){const e=s[i];if(e===r){_+=a;break}this.productsGrouped[e]&&(_+=this.productsGrouped[e].length)}this.currentRank=r,this.currentIndex=_,this.sliderOpen=!0},closeSlider(){this.sliderOpen=!1},nextImage(){this.currentIndex<this.allProducts.length-1?this.currentIndex++:this.currentIndex=0},prevImage(){this.currentIndex>0?this.currentIndex--:this.currentIndex=this.allProducts.length-1},getRankLabelClass(r){return{S:"text-yellow-500 drop-shadow-lg",A:"text-red-500 drop-shadow-lg",B:"text-blue-500 drop-shadow-lg",C:"text-green-500 drop-shadow-lg",D:"text-gray-500 drop-shadow-lg"}[r]||"text-gray-700"},getRankItemClass(r){return{S:"w-[calc(50%-6px)] md:w-[calc(33.333%-16px)]",A:"w-[calc(33.333%-16px)] md:w-[calc(25%-18px)]",B:"w-[calc(25%-6px)] md:w-[calc(20%-13px)]",C:"w-[calc(25%-6px)] md:w-[calc(20%-13px)]",D:"w-[calc(25%-6px)] md:w-[calc(20%-13px)]"}[r]||"w-[calc(50%-8px)] md:w-[calc(33.333%-11px)]"},getRankFlexClass(r){return{S:"gap-3 md:gap-6",A:"gap-3 md:gap-6",B:"gap-2 md:gap-4",C:"gap-2 md:gap-4",D:"gap-2 md:gap-4"}[r]||"gap-4"},onImageLoad(r){const a=r.target,s=a.parentElement;if(!s)return;const _=s.clientWidth,i=s.clientHeight,e=a.naturalWidth,x=a.naturalHeight;if(!e||!x||!_||!i)return;const y=Math.min(_,window.innerWidth-32),b=Math.min(i,window.innerHeight-192),C=y/e,w=b/x,p=Math.min(C,w),P=e*p,R=x*p;(p>1||e<y||x<b)&&(a.style.width=`${P}px`,a.style.height=`${R}px`)}}},q={class:"absolute w-full h-full overflow-y-auto pb-32"},J={class:"md:w-[760px] w-full mx-auto bg-white md:py-6 py-0"},K={class:"mx-auto relative w-full md:max-w-[430px]"},Q={class:"flex justify-end p-6 absolute top-0 w-full"},Z={class:"rounded-full py-0.5 w-fit px-4 text-sm border-2 border-white bg-white items-center flex align-center"},$=t("span",{class:"font-semibold text-sm"},"\u6B8B\xA0\xA0",-1),tt={class:"font-semibold text-sm"},et={class:"text-sm"},st=t("img",{src:"/images/icon_cash.png",class:"w-5 h-5"},null,-1),at={class:"font-semibold text-sm"},ot=t("span",{class:"text-sm"},"PT",-1),nt=["src"],ct={key:0,class:"px-4 py-6"},lt={class:"flex justify-center"},rt=["onClick"],it={class:"relative w-full"},dt={class:"w-full"},ht=["src"],ut={key:0,class:"absolute top-2 right-2 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded"},_t={key:0},mt={key:1,class:"text-red-300"},gt={class:"fixed w-full bottom-0 left-0 z-40 bg-white pt-2 pb-2"},xt=t("div",{class:"fixed inset-0 bg-black bg-opacity-75 transition-opacity"},null,-1),pt={class:"fixed inset-0 z-50 overflow-y-auto"},ft={class:"flex min-h-full items-center justify-center p-4"},bt={class:"relative"},yt={key:0,class:"absolute top-4 left-1/2 transform -translate-x-1/2 z-20"},wt={key:1,class:"relative py-20"},vt={class:"flex items-center justify-center px-4",style:{"min-height":"calc(100vh - 15rem)","max-height":"calc(100vh - 12rem)",width:"100%"}},kt=["src"],It={key:0,class:"hidden md:flex absolute inset-0 items-center justify-between px-6 pt-20 pointer-events-none"},Ct={key:1,class:"md:hidden absolute bottom-0 left-0 right-0 flex items-center justify-between px-4 py-3 bg-gradient-to-t from-black/80 to-transparent"},Pt={class:"flex flex-col items-center gap-1"},Rt={class:"bg-white bg-opacity-90 text-black px-4 py-1.5 rounded-full text-sm font-semibold shadow-lg"},jt={key:0,class:"bg-white bg-opacity-90 text-black px-3 py-1 rounded-full text-xs shadow-lg"},Gt={key:0},Ot={key:1,class:"text-red-600 font-semibold"},St={class:"hidden md:flex absolute bottom-4 left-1/2 transform -translate-x-1/2 gap-3 items-center"},Bt={class:"bg-black bg-opacity-70 text-white px-4 py-2 rounded-lg text-sm font-semibold shadow-lg"},Dt={key:0,class:"bg-black bg-opacity-70 text-white px-4 py-2 rounded-lg text-sm shadow-lg"},Lt={key:0},Ht={key:1,class:"text-red-300 font-semibold"},Nt={key:1,class:"w-full md:w-[768px] mx-auto mt-6"},Tt={class:"flex flex-wrap justify-between items-center"},At=t("h3",{class:"underline underline-offset-4 mb-4 px-4 text-lg"},"\u6392\u51FA\u5C65\u6B74",-1),Mt={class:"w-full"},Wt={class:"border-b border-collapse"},zt=t("th",{class:"text-center py-2"},"\u756A\u53F7",-1),Et=t("th",{class:"text-center py-2"},"\u540D\u524D",-1),Ft=t("th",{class:"text-center py-2"},"\u753B\u50CF",-1),Ut=t("th",{class:"text-center py-2"},"\u30EC\u30A2\u5EA6",-1),Vt=t("th",{class:"text-center py-2"},"\u30DD\u30A4\u30F3\u30C8",-1),Xt=t("th",{class:"text-center py-2"},"\u30E6\u30FC\u30B6\u30FC",-1),Yt=t("th",{class:"text-center py-2"},"\u6642\u9593",-1),qt=t("th",{class:"text-center py-2"},"\u72B6\u614B",-1),Jt={class:"border-b border-collapse"},Kt={class:"text-center py-2"},Qt={class:"text-center py-2"},Zt={class:"text-center py-1 flex justify-center"},$t=["src"],te={class:"text-center py-2"},ee={class:"text-center py-2"},se={class:"text-center py-2"},ae={class:"text-center py-2"},oe={class:"text-center py-2"};function ne(r,a,s,_,i,e){const x=h("Head"),y=h("GachaButtons"),b=h("TransitionChild"),C=h("XMarkIcon"),w=h("ChevronLeftIcon"),p=h("ChevronRightIcon"),P=h("DialogPanel"),R=h("Dialog"),O=h("TransitionRoot"),S=h("Pagination"),B=h("UserLayout");return o(),n(g,null,[d(x,{title:"\u30AC\u30C1\u30E3"}),d(B,null,{default:f(()=>[!s.is_admin&&s.gacha_log.length==0?(o(),n(g,{key:0},[t("div",q,[t("div",J,[t("div",K,[t("div",Q,[t("button",Z,[$,t("span",tt,l(e.format_number(s.gachas.data[0].count_rest)),1),t("span",et,"/"+l(e.format_number(s.gachas.data[0].count_card)),1),G(" \xA0\xA0\xA0\xA0 "),st,G("\xA0\xA0 "),t("span",at,l(e.format_number(s.gachas.data[0].point)),1),ot])]),t("img",{src:s.gachas.data[0].image,class:"block w-full"},null,8,nt)]),s.productsGrouped&&Object.keys(s.productsGrouped).length>0?(o(),n("div",ct,[(o(!0),n(g,null,j(e.sortedRanks,(c,m)=>(o(),n("div",{key:m,class:"mb-8"},[t("h3",{class:k(["text-2xl md:text-3xl font-bold mb-4 text-center",e.getRankLabelClass(m)])},l(m)+"\u8CDE ",3),t("div",lt,[t("div",{class:k(["flex flex-wrap justify-center items-center",e.getRankFlexClass(m)])},[(o(!0),n(g,null,j(c,(v,D)=>(o(),n("div",{key:v.id,onClick:ce=>e.openSlider(m,D),class:k(["relative cursor-pointer hover:opacity-80 transition-opacity flex justify-center",e.getRankItemClass(m)])},[t("div",it,[t("div",dt,[t("img",{src:v.image,class:"w-full object-contain rounded"},null,8,ht)]),s.gachas.data[0].show_stock?(o(),n("div",ut,[v.marks>0?(o(),n("span",_t,"\u6B8B\u308A: "+l(v.marks),1)):(o(),n("span",mt,"\u58F2\u5207\u308C"))])):u("",!0)])],10,rt))),128))],2)])]))),128))])):u("",!0)])]),t("div",gt,[d(y,{gacha:s.gachas.data[0]},null,8,["gacha"])]),d(O,{as:"template",show:i.sliderOpen},{default:f(()=>[d(R,{as:"div",class:"relative z-50",onClose:e.closeSlider},{default:f(()=>[d(b,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:f(()=>[xt]),_:1}),t("div",pt,[t("div",ft,[d(b,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:scale-95"},{default:f(()=>[d(P,{class:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all w-full max-w-4xl"},{default:f(()=>[t("div",bt,[t("button",{onClick:a[0]||(a[0]=(...c)=>e.closeSlider&&e.closeSlider(...c)),class:"absolute top-4 right-4 z-20 bg-black bg-opacity-70 text-white rounded-full p-2 hover:bg-opacity-90 transition-all"},[d(C,{class:"h-6 w-6"})]),e.currentProductRank?(o(),n("div",yt,[t("div",{class:k(["text-xl md:text-2xl font-bold px-6 py-2 rounded-lg shadow-lg bg-white bg-opacity-90",e.getRankLabelClass(e.currentProductRank)])},l(e.currentProductRank)+"\u8CDE ",3)])):u("",!0),e.allProducts&&e.allProducts.length>0?(o(),n("div",wt,[t("div",vt,[t("img",{src:e.allProducts[i.currentIndex].image,class:"object-contain",style:{"max-width":"calc(100vw - 2rem)","max-height":"calc(100vh - 15rem)",width:"100%",height:"100%"}},null,8,kt)]),e.allProducts.length>1?(o(),n("div",It,[t("button",{onClick:a[1]||(a[1]=I((...c)=>e.prevImage&&e.prevImage(...c),["stop"])),class:"pointer-events-auto bg-black bg-opacity-70 text-white rounded-full p-3 hover:bg-opacity-90 transition-all shadow-lg"},[d(w,{class:"h-6 w-6"})]),t("button",{onClick:a[2]||(a[2]=I((...c)=>e.nextImage&&e.nextImage(...c),["stop"])),class:"pointer-events-auto bg-black bg-opacity-70 text-white rounded-full p-3 hover:bg-opacity-90 transition-all shadow-lg"},[d(p,{class:"h-6 w-6"})])])):u("",!0),e.allProducts.length>1?(o(),n("div",Ct,[t("button",{onClick:a[3]||(a[3]=I((...c)=>e.prevImage&&e.prevImage(...c),["stop"])),class:"bg-white bg-opacity-90 text-black rounded-full p-2.5 hover:bg-opacity-100 transition-all shadow-lg"},[d(w,{class:"h-5 w-5"})]),t("div",Pt,[t("div",Rt,l(i.currentIndex+1)+" / "+l(e.allProducts.length),1),s.gachas.data[0].show_stock?(o(),n("div",jt,[e.allProducts[i.currentIndex].marks>0?(o(),n("span",Gt,"\u6B8B\u308A: "+l(e.allProducts[i.currentIndex].marks),1)):(o(),n("span",Ot,"\u58F2\u5207\u308C"))])):u("",!0)]),t("button",{onClick:a[4]||(a[4]=I((...c)=>e.nextImage&&e.nextImage(...c),["stop"])),class:"bg-white bg-opacity-90 text-black rounded-full p-2.5 hover:bg-opacity-100 transition-all shadow-lg"},[d(p,{class:"h-5 w-5"})])])):u("",!0),t("div",St,[t("div",Bt,l(i.currentIndex+1)+" / "+l(e.allProducts.length),1),s.gachas.data[0].show_stock?(o(),n("div",Dt,[e.allProducts[i.currentIndex].marks>0?(o(),n("span",Lt,"\u6B8B\u308A: "+l(e.allProducts[i.currentIndex].marks),1)):(o(),n("span",Ht,"\u58F2\u5207\u308C"))])):u("",!0)])])):u("",!0)])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])],64)):(o(),n("div",Nt,[t("div",Tt,[At,d(S,{search_cond:{...s.search_cond,id:s.gachas.data[0].id},route_name:"user.gacha",total:s.total},null,8,["search_cond","total"])]),t("table",Mt,[t("thead",null,[t("tr",Wt,[zt,Et,Ft,Ut,s.is_admin?(o(),n(g,{key:0},[Vt,Xt,Yt,qt],64)):u("",!0)])]),t("tbody",null,[(o(!0),n(g,null,j(s.gacha_log,(c,m)=>(o(),n("tr",Jt,[t("td",Kt,l(s.offset+m+1),1),t("td",Qt,l(c.name),1),t("td",Zt,[t("img",{class:"h-20",src:c.image},null,8,$t)]),t("td",te,l(c.rare),1),s.is_admin?(o(),n(g,{key:0},[t("td",ee,l(c.point),1),t("td",se,l(c.email),1),t("td",ae,l(c.gacha_time),1),t("td",oe,l(c.status),1)],64)):u("",!0)]))),256))])])]))]),_:1})],64)}const xe=M(Y,[["render",ne]]);export{xe as default};
