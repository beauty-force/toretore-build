import{H as D,L as H,r as h,o as a,c as o,a as d,w as f,F as g,b as t,t as c,g as G,I as j,f as u,n as k,d as I}from"./app.0c7ccbc0.js";import{U as N}from"./UserLayout.3639f5ae.js";import{P as T}from"./Pagination.df4683ab.js";import{G as A}from"./GachaButtons.a17f7a63.js";import{_ as M}from"./_plugin-vue_export-helper.cdc0426e.js";import{N as W,d as z,o as E,f as F,r as U,a as V}from"./toastify.1c7b2e94.js";import{r as X}from"./ChevronRightIcon.d54474cd.js";import"./EllipsisHorizontalIcon.9c79cf07.js";import"./PlayIcon.144a6269.js";const Y={components:{Head:D,UserLayout:N,Pagination:T,Link:H,GachaButtons:A,Dialog:W,DialogPanel:z,TransitionChild:E,TransitionRoot:F,XMarkIcon:U,ChevronLeftIcon:V,ChevronRightIcon:X},props:{errors:Object,gachas:Object,category_share:Object,gacha_log:Array,is_admin:Boolean,search_cond:Object,total:Number,offset:Number,productsGrouped:Object},data(){return{sliderOpen:!1,currentRank:"",currentIndex:0}},computed:{sortedRanks(){if(!this.productsGrouped)return{};const r=["S","A","B","C","D"],n={};return r.forEach(s=>{this.productsGrouped[s]&&(n[s]=this.productsGrouped[s])}),n},currentProducts(){return!this.currentRank||!this.productsGrouped[this.currentRank]?[]:this.productsGrouped[this.currentRank]},allProducts(){if(!this.productsGrouped)return[];const r=[];return["S","A","B","C","D"].forEach(s=>{this.productsGrouped[s]&&this.productsGrouped[s].forEach(_=>{r.push({..._,productRank:s})})}),r},currentProductRank(){return this.allProducts.length===0||this.currentIndex<0||this.currentIndex>=this.allProducts.length?"":this.allProducts[this.currentIndex].productRank||""}},methods:{format_number(r){return String(r).replace(/(.)(?=(\d{3})+$)/g,"$1,")},openSlider(r,n){const s=["S","A","B","C","D"];let _=0;for(let i=0;i<s.length;i++){const e=s[i];if(e===r){_+=n;break}this.productsGrouped[e]&&(_+=this.productsGrouped[e].length)}this.currentRank=r,this.currentIndex=_,this.sliderOpen=!0},closeSlider(){this.sliderOpen=!1},nextImage(){this.currentIndex<this.allProducts.length-1?this.currentIndex++:this.currentIndex=0},prevImage(){this.currentIndex>0?this.currentIndex--:this.currentIndex=this.allProducts.length-1},getRankLabelClass(r){return{S:"text-yellow-500 drop-shadow-lg",A:"text-red-500 drop-shadow-lg",B:"text-blue-500 drop-shadow-lg",C:"text-green-500 drop-shadow-lg",D:"text-gray-500 drop-shadow-lg"}[r]||"text-gray-700"},getRankItemClass(r){return{S:"w-[calc(50%-6px)] md:w-[calc(33.333%-16px)]",A:"w-[calc(33.333%-16px)] md:w-[calc(25%-18px)]",B:"w-[calc(25%-6px)] md:w-[calc(20%-13px)]",C:"w-[calc(25%-6px)] md:w-[calc(20%-13px)]",D:"w-[calc(25%-6px)] md:w-[calc(20%-13px)]"}[r]||"w-[calc(50%-8px)] md:w-[calc(33.333%-11px)]"},getRankFlexClass(r){return{S:"gap-3 md:gap-6",A:"gap-3 md:gap-6",B:"gap-2 md:gap-4",C:"gap-2 md:gap-4",D:"gap-2 md:gap-4"}[r]||"gap-4"},onImageLoad(r){const n=r.target,s=n.parentElement;if(!s)return;const _=s.clientWidth,i=s.clientHeight,e=n.naturalWidth,x=n.naturalHeight;if(!e||!x||!_||!i)return;const w=Math.min(_,window.innerWidth-32),b=Math.min(i,window.innerHeight-192),C=w/e,v=b/x,p=Math.min(C,v),P=e*p,R=x*p;(p>1||e<w||x<b)&&(n.style.width=`${P}px`,n.style.height=`${R}px`)}}},q={class:"absolute w-full h-full overflow-y-auto bg-gradient-to-b from-yellow-100 via-yellow-50 to-yellow-100"},J={class:"md:w-[760px] w-full mx-auto md:py-6 py-0"},K={class:"mx-auto relative w-full md:max-w-[430px]"},Q={class:"flex justify-end p-6 absolute top-0 w-full"},Z={class:"rounded-full py-0.5 w-fit px-4 text-sm border-2 border-white bg-white items-center flex align-center"},$=t("span",{class:"font-semibold text-sm"},"\u6B8B\xA0\xA0",-1),tt={class:"font-semibold text-sm"},et={class:"text-sm"},st=t("img",{src:"/images/icon_cash.png",class:"w-5 h-5"},null,-1),at={class:"font-semibold text-sm"},ot=t("span",{class:"text-sm"},"PT",-1),nt=["src"],lt={key:0,class:"px-4 py-6"},ct={class:"w-full flex justify-center"},rt=["onClick"],it={class:"relative w-full h-full"},dt={class:"w-full relative inline-block"},ht={class:"w-full relative inline-block"},ut=["src"],_t={key:0,src:"/images/psa10.png",class:"absolute bottom-2 left-1/2 transform -translate-x-1/2 w-[95%] object-contain pointer-events-none"},mt={key:0,class:"absolute top-2 right-2 bg-black bg-opacity-70 text-white text-xs px-2 py-1 rounded"},gt={key:0},xt={key:1,class:"text-red-300"},pt={class:"w-full sticky bottom-0 left-0 z-40 bg-white/90 backdrop-blur-sm pt-2 pb-2"},ft=t("div",{class:"fixed inset-0 bg-black bg-opacity-75 transition-opacity"},null,-1),bt={class:"fixed inset-0 z-50 overflow-y-auto"},yt={class:"flex min-h-full items-center justify-center p-4"},wt={class:"relative"},vt={key:0,class:"absolute top-4 left-1/2 transform -translate-x-1/2 z-20"},kt={key:1,class:"relative py-20"},It={class:"flex items-center justify-center px-4 relative",style:{"min-height":"calc(100vh - 15rem)","max-height":"calc(100vh - 12rem)",width:"100%"}},Ct={class:"relative inline-block w-full"},Pt=["src"],Rt={key:0,class:"hidden md:flex absolute inset-0 items-center justify-between px-6 pt-20 pointer-events-none"},jt={key:1,class:"md:hidden absolute bottom-0 left-0 right-0 flex items-center justify-between px-4 py-3 bg-gradient-to-t from-black/80 to-transparent"},Gt={class:"flex flex-col items-center gap-1"},St={class:"bg-white bg-opacity-90 text-black px-4 py-1.5 rounded-full text-sm font-semibold shadow-lg"},Lt={key:0,class:"bg-white bg-opacity-90 text-black px-3 py-1 rounded-full text-xs shadow-lg"},Ot={key:0},Bt={key:1,class:"text-red-600 font-semibold"},Dt={class:"hidden md:flex absolute bottom-4 left-1/2 transform -translate-x-1/2 gap-3 items-center"},Ht={class:"bg-black bg-opacity-70 text-white px-4 py-2 rounded-lg text-sm font-semibold shadow-lg"},Nt={key:0,class:"bg-black bg-opacity-70 text-white px-4 py-2 rounded-lg text-sm shadow-lg"},Tt={key:0},At={key:1,class:"text-red-300 font-semibold"},Mt={key:1,class:"w-full md:w-[768px] mx-auto mt-6"},Wt={class:"flex flex-wrap justify-between items-center"},zt=t("h3",{class:"underline underline-offset-4 mb-4 px-4 text-lg"},"\u6392\u51FA\u5C65\u6B74",-1),Et={class:"w-full"},Ft={class:"border-b border-collapse"},Ut=t("th",{class:"text-center py-2"},"\u756A\u53F7",-1),Vt=t("th",{class:"text-center py-2"},"\u540D\u524D",-1),Xt=t("th",{class:"text-center py-2"},"\u753B\u50CF",-1),Yt=t("th",{class:"text-center py-2"},"\u30EC\u30A2\u5EA6",-1),qt=t("th",{class:"text-center py-2"},"\u30DD\u30A4\u30F3\u30C8",-1),Jt=t("th",{class:"text-center py-2"},"\u30E6\u30FC\u30B6\u30FC",-1),Kt=t("th",{class:"text-center py-2"},"\u6642\u9593",-1),Qt=t("th",{class:"text-center py-2"},"\u72B6\u614B",-1),Zt={class:"border-b border-collapse"},$t={class:"text-center py-2"},te={class:"text-center py-2"},ee={class:"text-center py-1 flex justify-center"},se=["src"],ae={class:"text-center py-2"},oe={class:"text-center py-2"},ne={class:"text-center py-2"},le={class:"text-center py-2"},ce={class:"text-center py-2"};function re(r,n,s,_,i,e){const x=h("Head"),w=h("GachaButtons"),b=h("TransitionChild"),C=h("XMarkIcon"),v=h("ChevronLeftIcon"),p=h("ChevronRightIcon"),P=h("DialogPanel"),R=h("Dialog"),S=h("TransitionRoot"),L=h("Pagination"),O=h("UserLayout");return a(),o(g,null,[d(x,{title:"\u30AC\u30C1\u30E3"}),d(O,null,{default:f(()=>[!s.is_admin&&s.gacha_log.length==0?(a(),o(g,{key:0},[t("div",q,[t("div",J,[t("div",K,[t("div",Q,[t("button",Z,[$,t("span",tt,c(e.format_number(s.gachas.data[0].count_rest)),1),t("span",et,"/"+c(e.format_number(s.gachas.data[0].count_card)),1),G(" \xA0\xA0\xA0\xA0 "),st,G("\xA0\xA0 "),t("span",at,c(e.format_number(s.gachas.data[0].point.toLocaleString())),1),ot])]),t("img",{src:s.gachas.data[0].image,class:"block w-full"},null,8,nt)]),s.productsGrouped&&Object.keys(s.productsGrouped).length>0?(a(),o("div",lt,[(a(!0),o(g,null,j(e.sortedRanks,(l,m)=>(a(),o("div",{key:m,class:"mb-8"},[t("h3",{class:k(["text-2xl md:text-3xl font-bold mb-4 text-center",e.getRankLabelClass(m)])},c(m)+"\u8CDE ",3),t("div",ct,[t("div",{class:k(["w-full flex flex-wrap justify-center items-center",e.getRankFlexClass(m)])},[(a(!0),o(g,null,j(l,(y,B)=>(a(),o("div",{key:y.id,onClick:ie=>e.openSlider(m,B),class:k(["relative cursor-pointer hover:opacity-80 transition-opacity flex justify-center items-stretch",e.getRankItemClass(m)])},[t("div",it,[t("div",dt,[t("div",ht,[t("img",{src:y.image,class:"w-full object-contain rounded"},null,8,ut),y.badge==1?(a(),o("img",_t)):u("",!0)])]),s.gachas.data[0].show_stock?(a(),o("div",mt,[y.marks>0?(a(),o("span",gt,"\u6B8B\u308A: "+c(y.marks),1)):(a(),o("span",xt,"\u58F2\u5207\u308C"))])):u("",!0)])],10,rt))),128))],2)])]))),128))])):u("",!0)]),t("div",pt,[d(w,{gacha:s.gachas.data[0]},null,8,["gacha"])])]),d(S,{as:"template",show:i.sliderOpen},{default:f(()=>[d(R,{as:"div",class:"relative z-50",onClose:e.closeSlider},{default:f(()=>[d(b,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0","enter-to":"opacity-100",leave:"ease-in duration-200","leave-from":"opacity-100","leave-to":"opacity-0"},{default:f(()=>[ft]),_:1}),t("div",bt,[t("div",yt,[d(b,{as:"template",enter:"ease-out duration-300","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-200","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:scale-95"},{default:f(()=>[d(P,{class:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all w-full max-w-4xl"},{default:f(()=>[t("div",wt,[t("button",{onClick:n[0]||(n[0]=(...l)=>e.closeSlider&&e.closeSlider(...l)),class:"absolute top-4 right-4 z-20 bg-black bg-opacity-70 text-white rounded-full p-2 hover:bg-opacity-90 transition-all"},[d(C,{class:"h-6 w-6"})]),e.currentProductRank?(a(),o("div",vt,[t("div",{class:k(["text-xl md:text-2xl font-bold px-6 py-2 rounded-lg shadow-lg bg-white bg-opacity-90",e.getRankLabelClass(e.currentProductRank)])},c(e.currentProductRank)+"\u8CDE ",3)])):u("",!0),e.allProducts&&e.allProducts.length>0?(a(),o("div",kt,[t("div",It,[t("div",Ct,[t("img",{src:e.allProducts[i.currentIndex].image,class:"object-contain",style:{"max-width":"calc(100vw - 2rem)","max-height":"calc(100vh - 15rem)",width:"100%",height:"100%"}},null,8,Pt)])]),e.allProducts.length>1?(a(),o("div",Rt,[t("button",{onClick:n[1]||(n[1]=I((...l)=>e.prevImage&&e.prevImage(...l),["stop"])),class:"pointer-events-auto bg-black bg-opacity-70 text-white rounded-full p-3 hover:bg-opacity-90 transition-all shadow-lg"},[d(v,{class:"h-6 w-6"})]),t("button",{onClick:n[2]||(n[2]=I((...l)=>e.nextImage&&e.nextImage(...l),["stop"])),class:"pointer-events-auto bg-black bg-opacity-70 text-white rounded-full p-3 hover:bg-opacity-90 transition-all shadow-lg"},[d(p,{class:"h-6 w-6"})])])):u("",!0),e.allProducts.length>1?(a(),o("div",jt,[t("button",{onClick:n[3]||(n[3]=I((...l)=>e.prevImage&&e.prevImage(...l),["stop"])),class:"bg-white bg-opacity-90 text-black rounded-full p-2.5 hover:bg-opacity-100 transition-all shadow-lg"},[d(v,{class:"h-5 w-5"})]),t("div",Gt,[t("div",St,c(i.currentIndex+1)+" / "+c(e.allProducts.length),1),s.gachas.data[0].show_stock?(a(),o("div",Lt,[e.allProducts[i.currentIndex].marks>0?(a(),o("span",Ot,"\u6B8B\u308A: "+c(e.allProducts[i.currentIndex].marks),1)):(a(),o("span",Bt,"\u58F2\u5207\u308C"))])):u("",!0)]),t("button",{onClick:n[4]||(n[4]=I((...l)=>e.nextImage&&e.nextImage(...l),["stop"])),class:"bg-white bg-opacity-90 text-black rounded-full p-2.5 hover:bg-opacity-100 transition-all shadow-lg"},[d(p,{class:"h-5 w-5"})])])):u("",!0),t("div",Dt,[t("div",Ht,c(i.currentIndex+1)+" / "+c(e.allProducts.length),1),s.gachas.data[0].show_stock?(a(),o("div",Nt,[e.allProducts[i.currentIndex].marks>0?(a(),o("span",Tt,"\u6B8B\u308A: "+c(e.allProducts[i.currentIndex].marks),1)):(a(),o("span",At,"\u58F2\u5207\u308C"))])):u("",!0)])])):u("",!0)])]),_:1})]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])],64)):(a(),o("div",Mt,[t("div",Wt,[zt,d(L,{search_cond:{...s.search_cond,id:s.gachas.data[0].id},route_name:"user.gacha",total:s.total},null,8,["search_cond","total"])]),t("table",Et,[t("thead",null,[t("tr",Ft,[Ut,Vt,Xt,Yt,s.is_admin?(a(),o(g,{key:0},[qt,Jt,Kt,Qt],64)):u("",!0)])]),t("tbody",null,[(a(!0),o(g,null,j(s.gacha_log,(l,m)=>(a(),o("tr",Zt,[t("td",$t,c(s.offset+m+1),1),t("td",te,c(l.name),1),t("td",ee,[t("img",{class:"h-20",src:l.image},null,8,se)]),t("td",ae,c(l.rare),1),s.is_admin?(a(),o(g,{key:0},[t("td",oe,c(l.point.toLocaleString()),1),t("td",ne,c(l.email),1),t("td",le,c(l.gacha_time),1),t("td",ce,c(l.status),1)],64)):u("",!0)]))),256))])])]))]),_:1})],64)}const be=M(Y,[["render",re]]);export{be as default};
